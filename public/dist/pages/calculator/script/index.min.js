var Event,Queue,TexMathDisplay,adjustSize,angle_mode_toggle,angle_toggle_elem,calculate,clickAC,displaySet,getAngleMode,getNumberMode,initTex,keydown,keypress,keyup,mathOutput,mathResult,opener,processingEvent,real_mode_toggle,real_toggle_elem,repeatStringNumTimes,result,sd,view,indexOf=[].indexOf||function(t){for(var e=0,i=this.length;e<i;e++)if(e in this&&this[e]===t)return e;return-1};TexMathDisplay=function(){function t(t,e){this.focus=null!=e?e:0,this.value=null!=t?t:"",this.maxChildren=[2,1,2,2,3,1,4,4,4,4,void 0,void 0,1,1,1,1,2,2,3,2,3,1,2,1,2,1,1,1,1,2,4,4,2,2,1],this.specScope={left:[],right:[{op:"\\sin{",index:0},{op:"\\cos{",index:0},{op:"\\tan{",index:0},{op:"\\cot{",index:0},{op:"\\nlog{",index:1},{op:"\\pnlog{",index:2},{op:"\\logdec{",index:0},{op:"\\plogdec{",index:1},{op:"\\lognepe{",index:0},{op:"\\plognepe{",index:1},{op:"\\summary{",index:3},{op:"\\smallsummary{",index:3},{op:"\\product{",index:3},{op:"\\smallproduct{",index:3},{op:"\\limit{",index:2},{op:"\\limitn{",index:0},{op:"\\infint{",index:1},{op:"\\smallinfint{",index:1},{op:"\\integral{",index:3},{op:"\\smallintegral{",index:3}]},this.token={start:["\\frac{","\\sqrt{","\\sqrt[","\\power{","\\limit{","\\limitn{","\\summary{","\\smallsummary{","\\product{","\\smallproduct{","\\left\\{\\begin{array}{l}{","\\left[\\begin{array}{l}{","\\sin{","\\cos{","\\tan{","\\cot{","\\deri{","\\nderi{","\\fderi{","\\fnderi{","\\nlog{","\\pnlog{","\\lognepe{","\\plognepe{","\\logdec{","\\plogdec{","\\parentheses{","\\bracket{","\\brace{","\\absolute{","\\subscript{","\\psubscript{","\\integral{","\\smallintegral{","\\smallinfint{","\\infint{","\\exp{"],intermediate:["}{","]{","}\\\\{"],end:["}\\\\\\end{array}\\right.","}"],unimportant:["\\pm ","\\times ","\\div ","+","-","<",">","\\leq ","\\geq ","\\ll ","\\gg ","=","\\neq ","\\angle "],literal:["\\alpha ","\\beta ","\\gamma ","\\Gamma ","\\Delta ","\\delta ","\\epsilon ","\\varepsilon ","\\zeta ","\\eta ","\\Theta ","\\theta ","\\vartheta ","\\iota ","\\kappa ","\\varkappa ","\\Lambda ","\\lambda ","\\mu ","\\nu ","\\Xi ","\\xi ","\\Pi ","\\pi ","\\varpi ","\\rho ","\\varrho ","\\Sigma ","\\sigma ","\\varsigma ","\\tau ","\\Upsilon ","\\upsilon ","\\Phi ","\\phi ","\\varphi ","\\chi ","\\Psi ","\\psi ","\\Omega ","\\omega ","\\posinf ","\\neginf ","\\infty ","\\image "]},this.scope=[]}return t.prototype.setValue=function(t){return this.value=t},t.prototype.setFocus=function(t){return this.focus=t},t.prototype.insertNumber=function(t){return this.insert(t),this.focus++},t.prototype.insertCharacter=function(t){return this.insert(t),this.focus++},t.prototype.insertPlus=function(){return"+",this.insert("+"),this.focus++},t.prototype.insertSubstract=function(){return"-",this.insert("-"),this.focus++},t.prototype.insertMultiply=function(){return"\\times ",this.insert("\\times "),this.focus+=7},t.prototype.insertDiv=function(){return"\\div ",this.insert("\\div "),this.focus+=5},t.prototype.insertSDiv=function(){return"/",this.insert("/"),this.focus++},t.prototype.insertPM=function(){return"\\pm ",this.insert("\\pm "),this.focus+=4},t.prototype.insertFraction=function(){var t;return t="\\frac{}{}",this.insert(t),this.focus=this.focus+6,this.scope.push({op:"\\frac{",index:0})},t.prototype.insertSquareRoot=function(){return"\\sqrt{}",this.insert("\\sqrt{}"),this.focus=this.focus+6,this.scope.push({op:"\\sqrt{",index:0})},t.prototype.insertRoot=function(){var t;return t="\\sqrt[]{}",this.insert(t),this.focus=this.focus+8,this.scope.push({op:"\\sqrt[",index:1})},t.prototype.insertPower=function(){var t,e,i,s,n,r;if(null==(r=this.isTokenLeft())){if(null!=(e=this.focus<=0?null:this.value[this.focus-1])){if(t=this.value[this.focus-1],"0"===e||"1"===e||"2"===e||"3"===e||"4"===e||"5"===e||"6"===e||"7"===e||"8"===e||"9"===e)for(i=this.focus-2;;){if("0"!==(s=this.value[i])&&"1"!==s&&"2"!==s&&"3"!==s&&"4"!==s&&"5"!==s&&"6"!==s&&"7"!==s&&"8"!==s&&"9"!==s)break;t=this.value[i]+t}return n="\\power{"+t+"}{}",this.delByLength(t.length),this.insert(n),this.focus+=7+t.length+2,this.scope.push({op:"\\power",index:1})}return n="\\power{}{}",this.insert(n),this.focus+=7,this.scope.push({op:"\\power{",index:0})}return"unimportant"===r.label?(n="\\power{}{}",this.insert(n),this.focus+=7,this.scope.push({op:"\\power{",index:0})):"literal"===r.label?(n="\\power{"+r.token+"}{}",this.delByLength(r.token.length),this.insert(n),this.focus+=7+r.token.length+2,this.scope.push({op:"\\power",index:1})):void 0},t.prototype.insertSubscript=function(){var t;return t="\\subscript{}{}",this.insert(t),this.focus+=11,this.scope.push({op:"\\subscript{",index:0})},t.prototype.insertPSubscript=function(){var t;return t="\\psubscript{}{}{}",this.insert(t),this.focus+=12,this.scope.push({op:"\\psubscript{",index:0})},t.prototype.insertParentheses=function(){var t;return t="\\parentheses{}",this.insert(t),this.focus=this.focus+13,this.scope.push({op:"\\parentheses{",index:0})},t.prototype.insertBracket=function(){var t;return t="\\bracket{}",this.insert(t),this.focus+=9,this.scope.push({op:"\\bracket{",index:0})},t.prototype.insertAbsolute=function(){var t;return t="\\absolute{}",this.insert(t),this.focus+=10,this.scope.push({op:"\\absolute{",index:0})},t.prototype.insertBrace=function(){return"\\brace{}",this.insert("\\brace{}"),this.focus+=7,this.scope.push({op:"\\brace{",index:0})},t.prototype.insertSSum=function(){var t;return t="\\summary{}{}{}{}",this.insert(t),this.focus+=15,this.scope.push({op:"\\summary{",index:3})},t.prototype.insertSum=function(){var t;return t="\\smallsummary{}{}{}{}",this.insert(t),this.focus+=20,this.scope.push({op:"\\smallsummary{",index:3})},t.prototype.insertPProd=function(){var t;return t="\\product{}{}{}{}",this.insert(t),this.focus+=15,this.scope.push({op:"\\product{",index:3})},t.prototype.insertProd=function(){var t;return t="\\smallproduct{}{}{}{}",this.insert(t),this.focus+=20,this.scope.push({op:"\\smallproduct{",index:3})},t.prototype.insertIInt=function(){var t;return t="\\integral{}{}{}{}",this.insert(t),this.focus+=14,this.scope.push({op:"\\integral{",index:2})},t.prototype.insertInt=function(){var t;return t="\\smallintegral{}{}{}{}",this.insert(t),this.focus+=19,this.scope.push({op:"\\smallintegral{",index:2})},t.prototype.insertIInfInt=function(){var t;return t="\\infint{}{}",this.insert(t),this.focus+=8,this.scope.push({op:"\\infint{",index:0})},t.prototype.insertInfInt=function(){var t;return t="\\smallinfint{}{}",this.insert(t),this.focus+=13,this.scope.push({op:"\\smallinfint{",index:0})},t.prototype.insertLimit=function(){var t;return t="\\limit{}{}{}",this.insert(t),this.focus+=11,this.scope.push({op:"\\limit{",index:2})},t.prototype.insertLimitN=function(){var t;return t="\\limitn{}",this.insert(t),this.focus+=8,this.scope.push({op:"\\limitn{",index:0})},t.prototype.insertLt=function(){return"<",this.insert("<"),this.focus++},t.prototype.insertGt=function(){return">",this.insert(">"),this.focus++},t.prototype.insertLeq=function(){return"\\leq ",this.insert("\\leq "),this.focus+=5},t.prototype.insertGeq=function(){return"\\geq ",this.insert("\\geq "),this.focus+=5},t.prototype.insertLL=function(){return"\\ll ",this.insert("\\ll "),this.focus+=4},t.prototype.insertGG=function(){return"\\gg ",this.insert("\\gg "),this.focus+=4},t.prototype.insertEq=function(){return"=",this.insert("="),this.focus++},t.prototype.insertNeq=function(){return"\\neq ",this.insert("\\neq "),this.focus+=5},t.prototype.insertFDeri=function(){var t;return t="\\fderi{}{}",this.insert(t),this.focus+=7,this.scope.push({op:"\\fderi{",index:0})},t.prototype.insertFNDeri=function(){var t;return t="\\fnderi{}{}{}",this.insert(t),this.focus+=10,this.scope.push({op:"\\fderi{",index:1})},t.prototype.insertDeri=function(){return"\\deri{}",this.insert("\\deri{}"),this.focus+=6,this.scope.push({op:"\\deri{",index:0})},t.prototype.insertNDeri=function(){var t;return t="\\nderi{}{}",this.insert(t),this.focus+=7,this.scope.push({op:"\\nderi{",index:0})},t.prototype.insertSin=function(){return"\\sin{}",this.insert("\\sin{}"),this.focus+=5,this.scope.push({op:"\\sin{",index:0})},t.prototype.insertCos=function(){return"\\cos{}",this.insert("\\cos{}"),this.focus+=5,this.scope.push({op:"\\cos{",index:0})},t.prototype.insertTan=function(){return"\\tan{}",this.insert("\\tan{}"),this.focus+=5,this.scope.push({op:"\\tan{",index:0})},t.prototype.insertCot=function(){return"\\cot{}",this.insert("\\cot{}"),this.focus+=5,this.scope.push({op:"\\tan{",index:0})},t.prototype.insertLog=function(){var t;return t="\\nlog{}{}",this.insert(t),this.focus+=8,this.scope.push({op:"\\nlog{",index:1})},t.prototype.insertLogDec=function(){var t;return t="\\logdec{}",this.insert(t),this.focus+=8,this.scope.push({op:"\\logdec{",index:0})},t.prototype.insertLogNepe=function(){var t;return t="\\lognepe{}",this.insert(t),this.focus+=9,this.scope.push({op:"\\lognepe{",index:0})},t.prototype.insertPLog=function(){var t;return t="\\pnlog{}{}{}",this.insert(t),this.focus+=11,this.scope.push({op:"\\pnlog{",index:2})},t.prototype.insertPLogDec=function(){var t;return t="\\plogdec{}{}",this.insert(t),this.focus+=11,this.scope.push({op:"\\plogdec{",index:1})},t.prototype.insertPLogNepe=function(){var t;return t="\\plognepe{}{}",this.insert(t),this.focus+=12,this.scope.push({op:"\\plognepe{",index:1})},t.prototype.insertPBin=function(){var t;return t="\\power{2}{}",this.insert(t),this.focus+=10,this.scope.push({op:"\\power{",index:1})},t.prototype.insertExp=function(){return"\\exp{}",this.insert("\\exp{}"),this.focus+=5,this.scope.push({op:"\\exp{",index:0})},t.prototype.insertPosInf=function(){return"\\posinf ",this.insert("\\posinf "),this.focus+=8},t.prototype.insertNegInf=function(){return"\\neginf ",this.insert("\\neginf "),this.focus+=8},t.prototype.insertInfty=function(){return"\\infty ",this.insert("\\infty "),this.focus+=7},t.prototype.insertEuler=function(){return"\\euler ",this.insert("\\euler "),this.focus+=7},t.prototype.insertEqSys=function(t){var e;return e="\\left\\{\\begin{array}{l}{}\\\\\\end{array}\\right.",this.insert(e),this.focus+=24,this.scope.push({op:"\\left\\{\\begin{array}{l}",index:0})},t.prototype.insertEqCase=function(t){var e;return e="\\left[\\begin{array}{l}"+repeatStringNumTimes("{}\\\\",t)+"\\end{array}\\right.",this.insert(e),this.focus+=23,this.scope.push({op:"\\left[\\begin{array}{l}",index:0})},t.prototype.insertImage=function(){return"\\image ",this.insert("\\image "),this.focus+=7},t.prototype.insertPoint=function(){return this.insert(","),this.focus++},t.prototype.insertGreekLetter=function(t){var e;return e="\\"+t+" ",this.insert(e),this.focus+=e.length},t.prototype.isTokenLeft=function(){var t,e,i,s,n,r,o,u;i=(n=this.splitByFocus())[0],n[1],r=this.token;for(e in r)for(t=0,s=(u=r[e]).length;t<s;t++)if((o=u[t])===i.slice(-o.length))return{label:e,token:o};return null},t.prototype.isTokenRight=function(){var t,e,i,s,n,r,o,u;(s=this.splitByFocus())[0],r=s[1],n=this.token;for(e in n)for(t=0,i=(u=n[e]).length;t<i;t++)if((o=u[t])===r.substr(0,o.length))return{label:e,token:o};return null},t.prototype.enter=function(){var t;if(this.scope.findIndex(function(t){return"\\left\\{\\begin{array}{l}"===t.op||"\\left[\\begin{array}{l}"===t.op})>=0)return t=this.value.indexOf("}\\\\",this.focus)+3,this.focus=t,this.insert("{}\\\\"),this.focus++},t.prototype.insert=function(t){var e,i,s;return i=this.splitByFocus(),e=i[0],s=i[1],this.value=e+t+s},t.prototype.splitByFocus=function(){return 0===this.focus?["",this.value]:[this.value.slice(0,+(this.focus-1)+1||9e9),this.value.slice(this.focus,+this.value.length+1||9e9)]},t.prototype.shiftLeftFocus=function(){var t,e,i,s;if(0!==this.focus)return this.changed=!0,null!=(s=this.isTokenLeft())&&"unimportant"!==(e=s.label)&&"literal"!==e?("intermediate"===s.label?this.scope[this.scope.length-1].index--:"end"===s.label?(t=this.findLeftScope(),this.scope.push({op:t.token,index:t.numOfChildren-1})):"start"===s.label&&this.scope.pop(),this.focus-=s.token.length):null==s||"unimportant"!==(i=s.label)&&"literal"!==i?this.focus--:this.focus-=s.token.length},t.prototype.shiftRightFocus=function(){var t,e,i;if(this.focus!==this.value.length)return this.changed=!0,null!=(i=this.isTokenRight())&&"unimportant"!==(t=i.label)&&"literal"!==t?("intermediate"===i.label?this.scope[this.scope.length-1].index++:"start"===i.label?this.scope.push({op:i.token,index:0}):"end"===i.label&&this.scope.pop(),this.focus+=i.token.length):null==i||"unimportant"!==(e=i.label)&&"literal"!==e?this.focus++:this.focus+=i.token.length},t.prototype.findLeftScope=function(){var e,i,s;if(null!=(s=this.isTokenLeft())&&"end"===s.label&&"}"===s.token){for(i=new t(this.value.slice(0,+this.focus+1||9e9),this.focus),e=0,s=null;i.focus>0;)if(null!=(s=i.isTokenLeft())){if("end"===s.label?e++:"start"===s.label&&e>0&&e--,i.focus-=s.token.length,e<=0)break}else i.focus--;return{startPos:i.focus,endPos:this.focus,token:s.token,numOfChildren:this.maxChildren[this.token.start.findIndex(function(t){return t===s.token})]}}return null},t.prototype.displayCursor=function(){return 0===this.focus?"\\cursor "+this.value:[this.value.slice(0,+(this.focus-1)+1||9e9),this.value.slice(this.focus,+this.value.length+1||9e9)].join("\\cursor ")},t.prototype.display=function(){return 0===this.focus?"\\cursor "+this.value:[this.value.slice(0,+(this.focus-1)+1||9e9),this.value.slice(this.focus,+this.value.length+1||9e9)].join("\\cursor ").replace(new RegExp("{}","g"),"{\\Box}").replace("[]","[\\Box]")},t.prototype.getPostionOfCurrentScope=function(){var e,i,s,n,r,o;if(null!=(e=this.scope[this.scope.length-1])){for(r=(n=new t(this.value.slice(0,+this.focus+1||9e9),this.focus)).value.lastIndexOf(e.op),n.value=this.value,n.focus=r,n.shiftRightFocus(),s=1;s>0;)"start"===(o=n.isTokenRight()).label?s++:"end"===o.label&&s--,n.shiftRightFocus();return i=n.focus,[r,i]}return null},t.prototype.checkBeforeInsert=function(){var e,i,s,n,r,o,u,a;if(this.scope.length<=0)return null;i=this.scope[this.scope.length-1],r=this.specScope;for(s in r)if(u=r[s],u.findIndex(function(t){return t.op===i.op&&t.index===i.index})>=0&&"right"===s){for(o=new t(this.value,this.focus),n=1,a=null;o.focus<this.value.length;)if(null!=(a=o.isTokenRight())){if("end"===a.label?n--:"start"===a.label&&n>0&&n++,o.focus+=a.token.length,n<=0)break}else o.focus++;return e=this.value.slice(this.focus,+(o.focus-2)+1||9e9),this.focus=o.focus-1,this.delByLength(e.length),this.shiftRightFocus(),e}return null},t.prototype.checkCurrentScopeBeDeleted=function(){var t;return null!=(t=this.scope[this.scope.length-1])&&0===t.index},t.prototype.del=function(){var t,e,i,s,n,r;if(0!==this.focus)return null==(r=this.isTokenLeft())?this.delByLength(1):"unimportant"===(e=r.label)||"literal"===e?this.delByLength(r.token.length):"end"===r.label?this.shiftLeftFocus():"start"===(i=r.label)||"intermediate"===i?this.checkCurrentScopeBeDeleted()?(s=this.getPostionOfCurrentScope(),n=s[0],t=s[1],this.focus=t,this.delByLength(t-n),this.scope.pop()):this.shiftLeftFocus():void 0},t.prototype.delByLength=function(t){if(t>0)return this.value=this.value.substring(0,this.focus-t)+this.value.substring(this.focus),this.focus=this.focus-t>=0?this.focus-t:0},t.prototype.findOutVariables=function(){var t,e,i,s,n,r,o,u;for((n=new nearley.Parser(Grammar.ParserRules,Grammar.ParserStart,{keepHistory:!1})).feed(this.value),u=[],r=[n.results[0]];r.length;)if("Variable"===(s=r.shift()).operation&&u.findIndex(function(t){return s.value===t.value})<0&&u.push({value:s.value,tex:null!=s.tex?s.tex:s.value}),null!=s.children)for(e=0,i=(o=s.children).length;e<i;e++)t=o[e],r.push(t);return u.sort(function(t,e){return e.tex<t.tex})},t}(),repeatStringNumTimes=function(t,e){var i;for(i="";e>0;)i+=t,e--;return i},Event=function(){function t(t,e,i,s,n){this.charCode=t,this.keyCode=e,this.shiftKey=i,this.altKey=s,this.ctrlKey=n}return t.MathOutputTex=new TexMathDisplay,t.prototype.set=function(t,e,i,s,n){this.charCode=t,this.keyCode=e,this.shiftKey=i,this.altKey=s,this.ctrlKey=n},t.prototype.setCharCode=function(t){return this.charCode=t},t.prototype.setKeyCode=function(t){return this.keyCode=t},t.prototype.setShiftKey=function(t){return this.shiftKey=t},t.prototype.setAltKey=function(t){return this.altKey=t},t.prototype.setCtrlKey=function(t){return this.ctrlKey=t},t.prototype.keyPress=function(){var e,i,s,n,r,o,u,a,h,p,c,l,f,d,g,x;return o=this.charCode,indexOf.call([48,49,50,51,52,53,54,55,56,57],o)>=0||(u=this.charCode,indexOf.call(function(){for(f=[],i=65;i<=90;i++)f.push(i);return f}.apply(this),u)>=0)||(a=this.charCode,indexOf.call(function(){for(d=[],s=97;s<=122;s++)d.push(s);return d}.apply(this),a)>=0)?(h=this.charCode,indexOf.call([48,49,50,51,52,53,54,55,56,57],h)>=0&&t.MathOutputTex.insertNumber(String.fromCharCode(this.charCode)),p=this.charCode,(indexOf.call(function(){for(g=[],n=65;n<=90;n++)g.push(n);return g}.apply(this),p)>=0||(c=this.charCode,indexOf.call(function(){for(x=[],r=97;r<=122;r++)x.push(r);return x}.apply(this),c)>=0))&&t.MathOutputTex.insertCharacter(String.fromCharCode(this.charCode))):42===(l=this.charCode)||45===l||47===l||61===l?(e=t.MathOutputTex.checkBeforeInsert(),45===this.charCode&&t.MathOutputTex.insertSubstract(),42===this.charCode&&t.MathOutputTex.insertMultiply(),47===this.charCode&&t.MathOutputTex.insertSDiv(),61===this.charCode&&t.MathOutputTex.insertCharacter("="),null!=e&&t.MathOutputTex.insert(e)):44===this.charCode?44===this.charCode&&t.MathOutputTex.insertPoint():43===this.charCode&&(e=t.MathOutputTex.checkBeforeInsert(),43===this.charCode&&t.MathOutputTex.insertPlus(),null!=e&&t.MathOutputTex.insert(e)),t.MathOutputTex.display()},t.prototype.keydown=function(){switch(this.keyCode){case 8:t.MathOutputTex.del();break;case 13:t.MathOutputTex.enter();break;case 37:t.MathOutputTex.shiftLeftFocus();break;case 39:t.MathOutputTex.shiftRightFocus();break;case 54:this.shiftKey&&t.MathOutputTex.insertPower();break;case 57:this.shiftKey&&t.MathOutputTex.insertParentheses()}return t.MathOutputTex.display()},t.prototype.keyup=function(){return alert("Duy: Key up")},t.prototype.clickSymbolButton=function(e){switch(e){case"plus":t.MathOutputTex.insertPlus();break;case"substract":t.MathOutputTex.insertSubstract();break;case"multiply":t.MathOutputTex.insertMultiply();break;case"div":t.MathOutputTex.insertDiv();break;case"sdiv":t.MathOutputTex.insertSDiv();break;case"fraction":t.MathOutputTex.insertFraction();break;case"power":t.MathOutputTex.insertPower();break;case"squareroot":t.MathOutputTex.insertSquareRoot();break;case"root":t.MathOutputTex.insertRoot();break;case"parentheses":t.MathOutputTex.insertParentheses();break;case"bracket":t.MathOutputTex.insertBracket();break;case"absolute":t.MathOutputTex.insertAbsolute();break;case"brace":t.MathOutputTex.insertBrace();break;case"pm":t.MathOutputTex.insertPM();break;case"ssum":t.MathOutputTex.insertSSum();break;case"sum":t.MathOutputTex.insertSum();break;case"pprod":t.MathOutputTex.insertPProd();break;case"prod":t.MathOutputTex.insertProd();break;case"iint":t.MathOutputTex.insertIInt();break;case"int":t.MathOutputTex.insertInt();break;case"iinfint":t.MathOutputTex.insertIInfInt();break;case"infint":t.MathOutputTex.insertInfInt();break;case"limit":t.MathOutputTex.insertLimit();break;case"limitn":t.MathOutputTex.insertLimitN();break;case"lt":t.MathOutputTex.insertLt();break;case"gt":t.MathOutputTex.insertGt();break;case"leq":t.MathOutputTex.insertLeq();break;case"geq":t.MathOutputTex.insertGeq();break;case"ll":t.MathOutputTex.insertLL();break;case"gg":t.MathOutputTex.insertGG();break;case"eq":t.MathOutputTex.insertEq();break;case"neq":t.MathOutputTex.insertNeq();break;case"fderi":t.MathOutputTex.insertFDeri();break;case"fnderi":t.MathOutputTex.insertFNDeri();break;case"deri":t.MathOutputTex.insertDeri();break;case"nderi":t.MathOutputTex.insertNDeri();break;case"sin":t.MathOutputTex.insertSin();break;case"cos":t.MathOutputTex.insertCos();break;case"tan":t.MathOutputTex.insertTan();break;case"cot":t.MathOutputTex.insertCot();break;case"log":t.MathOutputTex.insertLog();break;case"logdec":t.MathOutputTex.insertLogDec();break;case"ln":t.MathOutputTex.insertLogNepe();break;case"plog":t.MathOutputTex.insertPLog();break;case"plogdec":t.MathOutputTex.insertPLogDec();break;case"pln":t.MathOutputTex.insertPLogNepe();break;case"pbin":t.MathOutputTex.insertPBin();break;case"exp":t.MathOutputTex.insertExp();break;case"posinf":t.MathOutputTex.insertPosInf();break;case"neginf":t.MathOutputTex.insertNegInf();break;case"inf":t.MathOutputTex.insertInfty();break;case"subscript":t.MathOutputTex.insertSubscript();break;case"psubscript":t.MathOutputTex.insertPSubscript();break;case"eqsys":t.MathOutputTex.insertEqSys();break;case"image":t.MathOutputTex.insertImage();break;case"angle":t.MathOutputTex.insertAngle();break;case"euler":t.MathOutputTex.insertEuler()}return t.MathOutputTex.display()},t.prototype.clickGreekButton=function(e){return t.MathOutputTex.insertGreekLetter(e),t.MathOutputTex.display()},t}(),displaySet=function(t){return t.hasOwnProperty("open_set")?"\\left("+t.open_set.min+"; "+t.open_set.max+"\\right)":t.hasOwnProperty("closed_set")?"\\left["+t.closed_set.min+"; "+t.closed_set.max+"\\right]":t.hasOwnProperty("left_open_set")?"\\left("+t.left_open_set.min+"; "+t.left_open_set.max+"\\right]":t.hasOwnProperty("right_open_set")?"\\left["+t.right_open_set.min+"; "+t.right_open_set.max+"\\right)":t.hasOwnProperty("unions")?"\\left("+t.unions.map(function(t){return displaySet(t)}).reduce(function(t,e){return t+"\\cup"+e})+"\\right)":t.hasOwnProperty("intersections")?"\\left("+t.intersections.map(function(t){return displaySet(t)}).reduce(function(t,e){return t+"\\cap"+e})+"\\right)":void 0},Queue=MathJax.Hub.queue,mathOutput=null,mathResult=null,angle_toggle_elem=document.querySelector(".angle-mode-toggle"),angle_mode_toggle=new Switchery(angle_toggle_elem,{size:"small"}),real_toggle_elem=document.querySelector(".real-mode-toggle"),real_mode_toggle=new Switchery(real_toggle_elem,{size:"small"}),processingEvent=new Event,initTex=null,result=null,$(document).ready(function(){return Queue.Push(function(){var t,e,i;return mathOutput=MathJax.Hub.getAllJax("MathOutput")[0],mathResult=MathJax.Hub.getAllJax("MathResult")[0],window.location.href,e=window.location.href,t=e.indexOf("init"),e.indexOf("init")>=0&&(i=decodeURIComponent(e.substring(t+5)),view(i+"\\cursor "),Event.MathOutputTex.value=i,Event.MathOutputTex.focus=i.length),$(".menu-symbol").css("visibility","visible"),$(".button-symbol").css("visibility","visible"),$("#MathOutputBox").css("visibility","visible"),$(document).keypress(keypress),$(document).keydown(keydown),$("#calculate").click(calculate),$("#ac").click(clickAC),$("#sd").click(sd),adjustSize()})}),keypress=function(t){var e,i,s,n;if(!((i=$(":focus")).length>0&&"virtual-input"!==i.attr("id")))return e=t.which||t.keyCode,n=null,s=getNumberMode(),105===e&&"complex"===s?n=processingEvent.clickSymbolButton("image"):(processingEvent.set(e,null,t.shiftKey,t.altKey,t.ctrlKey),n=processingEvent.keyPress()),view(n)},keydown=function(t){var e,i;return e=t.which||t.keyCode,processingEvent.set(null,e,t.shiftKey,t.altKey,t.ctrlKey),i=processingEvent.keydown(),view(i)},keyup=function(t){return processingEvent.keyup()},$(".button-symbol").click(function(){var t;return t=null,$(this).hasClass("button-for-image")?"complex"===getNumberMode()&&(t=processingEvent.clickSymbolButton($(this).data("op"))):t=$(this).hasClass("button-greek")?processingEvent.clickGreekButton($(this).data("op")):processingEvent.clickSymbolButton($(this).data("op")),view(t)}),calculate=function(){var t;return(t=Event.MathOutputTex.findOutVariables().filter(function(t){return"\\image "!==t.value})).length>0?(bootbox.prompt({title:"Các biến sử dụng",value:t.map(function(t){return t.value}),inputType:"checkbox",inputOptions:t.map(function(t){return{text:"\\("+t.tex+"\\)",value:t.value}}),closeButton:!1,callback:function(t){return $("#MathResultBox").css("visibility","visible"),$.post("/tinh-toan",{variables:t,angleMode:getAngleMode(),latexString:Event.MathOutputTex.value,numberMode:getNumberMode()},function(e){var i;return result=e,null!=e.beauty&&(e.beauty instanceof String||"string"==typeof e.beauty)&&Queue.Push(["Text",mathResult,e.beauty]),i="",null!=e.root&&(1===t.length?i=0===e.root.length?"$$\\text{Bài toán vô nghiệm}$$":e.root.accurate.map(function(e){return"$$"+t[0]+"="+e+"$$"}).join("\n"):t.length>1&&(i=0===e.root.length?"$$\\text{Bài toán vô nghiệm}$$":e.root.accurate.map(function(e){return"$$\\left("+t.join(";")+"\\right) = \\left("+e.join(";")+"\\right)$$"}).join("\n")),$("#MathResult").html(i),MathJax.Hub.Queue(["Typeset",MathJax.Hub])),null!=e.rootset&&(1===t.length&&(i="$$S_{"+t[0]+"}="+displaySet(e.rootset)+"$$"),$("#MathResult").html(i),MathJax.Hub.Queue(["Typeset",MathJax.Hub])),$("#loading-for-result").css("visibility","hidden"),adjustSize()})},buttons:{confirm:{label:"Sử dụng"},cancel:{label:"Không sử dụng"}}}),MathJax.Hub.Queue(["Typeset",MathJax.Hub])):($("#MathResultBox").css("visibility","visible"),$("#loading-for-result").css("visibility","visible"),$.post("/tinh-toan",{angleMode:getAngleMode(),latexString:Event.MathOutputTex.value},function(t){return result=t,Queue.Push(["Text",mathResult,t.beauty]),$("#loading-for-result").css("visibility","hidden"),adjustSize()}))},sd=function(){return Queue.Push(["Text",mathResult,result.normal]),adjustSize()},view=function(t){if(null!=t)return Queue.Push(["Text",mathOutput,"\\displaystyle "+t]),adjustSize()},clickAC=function(){var t,e;return e=window.location.href,(t=e.indexOf("&init"))>=0?window.location.href=e.slice(0,+(t-1)+1||9e9):window.location.reload(!0)},getAngleMode=function(){return angle_toggle_elem.checked?"rad":"deg"},getNumberMode=function(){return real_toggle_elem.checked?"real":"complex"},adjustSize=function(){var t,e;return t=$("#MathOutput").height(),$("#MathOutputBox").css("height",t+100+"px"),$("#virtual-input").css("height",t+100+"px"),e=$("#MathOutput").height(),$("#MathOutputBox").css("height",e+100+"px"),$("#loading-for-result").css("height",e+100+"px"),$("#loading-for-result").css("padding-top",(e+100-80)/2+"px")},opener=window.opener,$("#save-close").click(function(){var t;return(t=Event.MathOutputTex.findOutVariables().filter(function(t){return"image"!==t.value})).length>1?(bootbox.prompt({title:"Các biến sử dụng",value:t.map(function(t){return t.value}),inputType:"checkbox",inputOptions:t.map(function(t){return{text:"\\("+t.tex+"\\)",value:t.value}}),closeButton:!1,callback:function(t){return opener.getMathDisplayTex(Event.MathOutputTex.value,getAngleMode(),JSON.stringify(t)),window.close()},buttons:{confirm:{label:"Sử dụng"},cancel:{label:"Không sử dụng"}}}),MathJax.Hub.Queue(["Typeset",MathJax.Hub])):1===t.length?(opener.getMathDisplayTex(Event.MathOutputTex.value,getAngleMode(),JSON.stringify(t.map(function(t){return t.value}))),window.close()):(opener.getMathDisplayTex(Event.MathOutputTex.value,getAngleMode()),window.close())}),$("#write-close").click(function(){var t,e,i;return e=window.location.href,t=e.indexOf("ck"),e.indexOf("ck")>=0?(i=e.substring(t+3),opener.insertMathFormula(i,Event.MathOutputTex.value),window.close()):(opener.setMathFormula(Event.MathOutputTex.value,getAngleMode()),window.close())});