var Queue,adjustSize,adjustSizeAll,contentEditor,exerciseInfo,formula,input_opener;Queue=MathJax.Hub.queue,formula=[],contentEditor=null,exerciseInfo=null,input_opener=null,$("#exercise-input-wizard").steps({headerTag:"h3",bodyTag:"section",stepsOrientation:"vertical",labels:{finish:"Kết thúc",next:"Tiếp theo",previous:"Trước"},onStepChanging:function(e,t,n){var i,o,a,r,u,l;if(1===t&&!exerciseInfo.NoParameter)for(formula=[],[],[],r=a=0,u=(o=$(".formula-contaniner").find(".input-formula-row")).length;a<u;r=++a){if(o[r],l=o.eq(r).find(".input-formula-bare-tex").eq(0).text(),i=o.eq(r).find(".input-formula-anglemode").eq(0).text(),""===l)return bootbox.alert("Công thức không được phép rỗng!"),!1;formula.push({tex:l,anglemode:i})}return!0},onStepChanged:function(){return adjustSizeAll()},onFinished:function(e,t){var n,i;return n=contentEditor.getData(),window.location.href.indexOf("sua-bai-giai")<0?exerciseInfo.NoParameter?window.location.href="/luu-bai-giai?mabaitap="+exerciseInfo.ExerciseId+"&noidung="+encodeURIComponent(n):window.location.href="/luu-bai-giai?mabaitap="+exerciseInfo.ExerciseId+"&noidung="+encodeURIComponent(n)+"&congthuc="+encodeURIComponent(JSON.stringify(formula)):(i=JSON.parse($("#solution").val()),exerciseInfo.NoParameter?window.location.href="/luu-sua-bai-giai?mabaitap="+exerciseInfo.ExerciseId+"&mabaigiai="+i.SolutionId+"&noidung="+encodeURIComponent(n):window.location.href="/luu-sua-bai-giai?mabaitap="+exerciseInfo.ExerciseId+"&mabaigiai="+i.SolutionId+"&noidung="+encodeURIComponent(n)+"&congthuc="+encodeURIComponent(JSON.stringify(formula)))}}),$(".add-param").click(function(){return bootbox.prompt({title:"Chọn 1 tham số đầu vào để hiển thị",inputType:"checkbox",inputOptions:parameter.map(function(e){return{text:"\\("+e.tex+"\\)",value:""+e.tex}}),closeButton:!1,callback:function(e){if(e.length>0)return e[0],exerciseEditor.insertText("\\("+e[0]+"\\)"),MathJax.Hub.Queue(["Typeset",MathJax.Hub])}}),MathJax.Hub.Queue(["Typeset",MathJax.Hub])}),$(document).ready(function(){return CKEDITOR.replace("input-content",{allowedContent:!0,entities:!1,extraAllowedContent:"span",fillEmptyBlocks:!1,tabSpaces:0,basicEntities:!1}),contentEditor=CKEDITOR.instances["input-content"],exerciseInfo=JSON.parse($("#exerciseInfo").val())}),$(".add-new-formula").click(function(){return $(".formula-contaniner").append('<div class="row input-formula-row"> <div class="col-md-12 input-formula-box"> <div class="input-formula"> <div class="input-formula-tex">\\(\\)</div> <div class="input-formula-bare-tex hidden"></div> <div class="input-formula-anglemode hidden"></div> </div> </div> </div>'),MathJax.Hub.Queue(["Typeset",MathJax.Hub]),$(".input-formula").click(function(){return input_opener=$(this),window.open("/may-tinh-kogida?editor=true&solver=false","popupWindow","width=600, height=400, scrollbars=yes")})}),$(".input-formula").click(function(){return input_opener=$(this),window.open("/may-tinh-kogida?editor=true&solver=false","popupWindow","width=600, height=400, scrollbars=yes")}),$(".open-editor").click(function(){return window.open("/may-tinh-kogida?editor=true&solver=false&ck=input-content","popupWindow","width=600, height=400, scrollbars=yes")}),$(".open-param").click(function(){return swal({title:"Nhập công thức vào bài giải",html:formula.map(function(e,t){return"<div class='row input-formula-select'><div class='col-md-2'>Công thức "+(t+1)+"</div><div class='col-md-6 text-left'>\\("+e.tex+"\\)</div><div class='col-md-2'><input type='checkbox' data-formula='"+t+"' /><label style='margin-left:5px;'>Chọn</label></div><div class='col-md-2'><select data-formula='"+t+"'><option value='1' selected>Dạng 1</option><option value='2'>Dạng 2</option><option value='3'>Dạng 3</option><option value='4'>Dạng 4</option></select></div></div>"}).reduce(function(e,t){return e+t}),width:"800px",focusConfirm:!0,preConfirm:function(){var e,t,n,i,o,a;for(a=[],i=n=0,o=(t=$(".input-formula-select")).length;n<o;i=++n)t[i],t.eq(i).find("input[type=checkbox]").is(":checked")?(e=t.eq(i).find("select").val(),a.push(contentEditor.insertHtml("<span formula='"+i+"' format='"+e+"' style='font-weight: bolder'>Công thức "+(i+1)+"</span><p><p>"))):a.push(void 0);return a}}),MathJax.Hub.Queue(["Typeset",MathJax.Hub])}),adjustSizeAll=function(){var e,t,n,i,o,a,r;for(o=[],n=t=0,i=(r=$(".input-formula-tex")).length;t<i;n=t+=1)e=(a=r.eq(n)).height(),o.push(a.parent().css("cssText","height: "+(e+20)+"px !important;"));return o},adjustSize=function(){var e,t;return t=input_opener.find("div").eq(0),e=t.height(),input_opener.css("cssText","height: "+(e+20)+"px !important;")},window.setMathFormula=function(e,t){return input_opener.find("div").eq(0).text("\\(\\displaystyle "+e+"\\)"),input_opener.find("div").eq(1).text(e),input_opener.find("div").eq(2).text(t),MathJax.Hub.Queue(["Typeset",MathJax.Hub]),adjustSize()},window.insertMathFormula=function(e,t){return CKEDITOR.instances[e].insertText("\\(\\displaystyle "+t+"\\)")};